
{% extends 'base/head.html' %}

{% block content %}
<div class="row">
	<!-- Typeahead -->
	<div class="card col-12">
		<div class="card-header">
			<h5 class="card-title">Client List</h5>
		</div>

		<div class="card-body">
			<!-- <p class="mb-4">Table dibawah ini berupa list seluruh unit dari organization JADDI</p> -->
			<div class="btn-group mr-lg-3 mb-3">
				<a href="{% url 'client-add' %}"><button type="button" class="btn btn-light"><i class="icon-diff-added"></i> <span class="d-none d-lg-inline-block ml-2">Add Data Pribadi</span></button></a>
			</div>
			<div class="row ">
				<div class="col-12">

					<table class="table">
					  <thead>
					    <tr>
					      <th scope="col">#</th>
					      <th scope="col">Nama</th>
					      <th scope="col">Color</th>
					      <th scope="col">Umur</th>
					      <th scope="col">Gender</th>
					      <th scope="col">Pekerjaan</th>
					      <th scope="col">Domisili</th>
					      <th scope="col" class="text-center">Detail</th>
					      <th scope="col" class="text-center">Followup</th>
					      <th scope="col" class="text-center">Action</th>
					    </tr>
					  </thead>
					  <tbody>
					  	{% for client_staff in client_staff_list %}
					  		{% comment %}
					  		{% if client_staff.color != 'ff0000'%}
							<tr style="color: white;background-color: #{{client_staff.color}}">
							{% else %}
							<tr>
							{% endif %}
							{% endcomment %}
							<tr>
						      <td scope="row">{{forloop.counter}}</td>
						      <td>
						      	<span style="display: inline-block;" >{{client_staff.client.nama}}</span>
						      </td>
						      <td>
						      	<i style="display: inline-block;color: #{{client_staff.color}}" class="icon-circle2 mr-3"></i>
						      </td>
						      <td scope="row">{{client_staff.client.umur}}</td>
						      <td scope="row">{{client_staff.client.gender}}</td>
						      <td scope="row">{{client_staff.client.pekerjaan}}</td>
						      <td scope="row">{{client_staff.client.domisili}}</td>
						      <td scope="row" class="text-center">
						      	<a href="{% url 'client-detail-list' client_staff.client.id %}"><i class="icon-file-eye"></i></a>
						      </td>
						      <td scope="row" class="text-center">
						      	<a href="{% url 'client-followup-list' client_staff.client.id %}"><i class="icon-clipboard2"></i></a>
						      </td>
						      <td class="text-center">
									<div class="list-icons">
										<div class="dropdown">
											<a href="#" class="list-icons-item" data-toggle="dropdown">
												<i class="icon-menu9"></i>
											</a>

											<div class="dropdown-menu dropdown-menu-right">
												<a href="{% url 'client-edit' client_staff.client.id %}" class="dropdown-item"><i class="icon-pencil7"></i> Edit</a>
												<span data-toggle="modal" data-target="#modal_mini" class="dropdown-item change-color-button" data-client_id="{{client_staff.client.id}}"><i class="icon-pencil7"></i> Edit Color</span>

												<a href="{% url 'client-delete' client_staff.client.id %}" class="dropdown-item"><i class="icon-trash"></i> Delete</a>
											</div>
										</div>
									</div>
								</td>
						    </tr>
						{% endfor %}
					    
					    
					  </tbody>
					</table>

					

					

					
				</div>

			</div>
		</div>

	</div>
	<!-- /typeahead -->
</div>
<!-- Mini modal -->
<div id="modal_mini" class="modal fade" tabindex="-1">
	<div class="modal-dialog modal-xs">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Pick Color</h5>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>

			<div class="modal-body">
				<!-- <h6 class="font-weight-semibold">Text in a modal</h6> -->
				<input type="color" class="form-control"  name="client-color" id="client-color">
				
			</div>

			<div class="modal-footer">
				<button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" id="color-button-save">Save changes</button>
			</div>
		</div>
	</div>
</div>
<!-- /mini modal -->
<script type="text/javascript">
	$(function() {
		var client_id = '';
		$('.change-color-button').click(function(){
			client_id = $(this).data('client_id');
			console.log(client_id)

		});
		// $('#client-color').colorpicker();
		$('#color-button-save').click(function(){
			console.log(123);
			var color_value = $('#client-color').val()
			color_value = color_value.replace('#', '')
			var string_color_url = "{% url 'client-edit-color' 0 '!99' %}";
			string_color_url = string_color_url.replace(0, client_id)
			string_color_url = string_color_url.replace('!99', color_value)
			console.log(string_color_url);
			window.location.href = string_color_url;

		});
		$(".table-row").click(function() {
		 	var link = $(this).data('href');
		 	window.location.href = link;
		});

	});
</script>
{% endblock content %}