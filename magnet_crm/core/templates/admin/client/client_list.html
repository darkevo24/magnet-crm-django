
{% extends 'base/head.html' %}


{% load static %}
{% load core_extras %}
{% block content %}
<style type="text/css">
	.media{
        border: 1px solid silver;
        border-radius: 15px;
        padding: 10px;
    }
</style>
<div class="row">
	<!-- Typeahead -->
	<div class="card col-12 card_cus">
		<div class="card-header">
			<h5 class="card-title">Client List</h5>
		</div>
		

		<div class="card-body">
			<!-- <p class="mb-4">Table dibawah ini berupa list seluruh unit dari organization JADDI</p> -->
			<div class="btn-group mr-lg-3 mb-3">
				<a href="{% url 'client-add' %}"><button type="button" class="btn btn-light"><i class="icon-diff-added"></i> <span class="d-none d-lg-inline-block ml-2">Add Data Pribadi</span></button></a>
			</div>

			<div class="row ">
				<div class="col-12">
					<input type="text" id="search_input"  class="form-control mb-3" placeholder="Search Client">
					
					

					<!-- Nav tabs -->
					<ul class="nav nav-tabs">
					  <li class="nav-item">
					    <a class="nav-link active" data-toggle="tab" href="#home">Data Followup</a>
					  </li>
					  <li class="nav-item">
					    <a class="nav-link" data-toggle="tab" href="#menu1">Client</a>
					  </li>
					</ul>

					<!-- Tab panes -->
					<div class="tab-content">
					  <div class="tab-pane active" id="home">
					  		
					  		<!-- start -->
					  							<ul class="media-list">
                                        
                                            
                                {% for client_staff in client_staff_list %}
                                    
                                    {% if not client_staff.client.is_deposit %}
                                    <li class="media">
                                        <div class="media-body ">
                                            <div class="media-title font-weight-semibold">
                                                <i style="display: inline-block;color: #{{client_color|dict_get:client_staff.client.id}}" class="icon-circle2 mr-1"></i>
                                                {{client_staff.client.nama}} {% if client_staff.is_hot %} <i style="color:red"><b>(Hot Client)</b></i> {% endif %}
                                            </div>
                                            <div class="pl-1 text-muted">{{client_staff.client.email}}</div>
                                            <div class="pl-1 text-muted">
                                                {% if client.source_detail_2 is not None and client.source_detail_2 != '' %}
                                                    {{client.get_source_detail_2_display}} 
                                                {% elif client.source_detail_1 is not None and client.source_detail_1 != '' %}
                                                    {{client.get_source_detail_1_display}} 
                                                {% else %}
                                                    {{client.get_source_display|default:'-'}}
                                                {% endif %}
                                            </div>

                                            

                                        </div>

                                       <div class="align-self-center ml-3">
                                            <!-- <i class="fab fa-whatsapp mr-3 whatsapp-button" data-client_id="{{client_staff.client.id}}" data-journey_type="whatsapp" style="font-size:1.8em"></i> -->
                                            <img class="list-icons-item clickable whatsapp-button" data-client_id="{{client_staff.client.id}}"  data-popup="tooltip" title="WA" data-journey_type="whatsapp" src="{% static 'magnet/images/admin-wa.png' %}" style="height:2.4em" >
                                            
                                            <!-- <i class="fas fa-phone mr-3 call-button" style="font-size: 1.8em" data-client_id="{{client_staff.client.id}}" data-journey_type="called">
                                            </i> -->
                                            
                                            <!-- <a class="list-icons-item clickable call-button" data-popup="tooltip" title="Call" data-client_id="{{client_staff.client.id}}" data-journey_type="called" data-toggle="modal" data-trigger="hover" data-target="#call"><i class="fas fa-phone mr-3" style="font-size: 1.8em"></i></a> -->

                                            <img class="list-icons-item clickable call-button" data-popup="tooltip" title="Call" data-client_id="{{client_staff.client.id}}" data-journey_type="called" data-toggle="modal" data-trigger="hover" data-target="#call" src="{% static 'magnet/images/admin-call.png' %}" style="height:2.4em" >


                                            <!-- <a class="list-icons-item" href="{% url 'client-followup-list' client_staff.client.id  %}"><i class="far fa-calendar-plus mr-3" style="font-size: 1.8em"></i></a> -->

                                            <a href="{% url 'client-followup-list' client_staff.client.id  %}"><img class="list-icons-item"  data-popup="tooltip" title="Feedback" src="{% static 'magnet/images/admin-feedback.png' %}" style="height:2.4em" ></a>


                                            <div class="list-icons">
                                                <div class="dropdown">
                                                    <a href="#" class="list-icons-item" data-toggle="dropdown">
                                                        <i class="icon-menu9" style="font-size: 1.8em"></i>
                                                    </a>

                                                    <div class="dropdown-menu dropdown-menu-right">
                                                        <a href="{% url 'client-detail-list' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="icon-file-eye"></i> Client Detail
                                                        </a>
                                                        <a href="{% url 'client-edit' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="fas fa-edit"></i> Client Edit
                                                        </a>

                                                        <a href="{% url 'client-schedule-list' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="fas fa-calendar-alt"></i> List Schedule
                                                        </a>
                                                        <a href="{% url 'client-schedule-add' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="fas fa-calendar-plus"></i> Add Schedule
                                                        </a>
                                                        <span data-toggle="modal" data-target="#modal_mini" class="dropdown-item change-color-button" data-client_id="{{client_staff.client.id}}"><i class="icon-pencil7"></i>Edit Color</span>


                                                        <span  class="dropdown-item" onclick="set_hot({{client_staff.client.id}},{% if client_staff.is_hot %}'false' {% else %} 'true' {% endif %})"><i class="icon-pencil7"></i>Toggle Hot Client</span>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </li>
                                    {% endif %}
                                    
                                {% endfor %}

                            
                        </ul>
		

					  		<!-- start end -->


					  </div>
					  <div class="tab-pane fade" id="menu1">
					  						<ul class="media-list">
                                        
                                
                             {% for client_staff in client_staff_list %}
                                 {% if client_staff.client.is_deposit %}

                                    
                                    
                                    <li class="media">
                                        <div class="media-body ">
                                            <div class="media-title font-weight-semibold">
                                                <i style="display: inline-block;color: #{{client_color|dict_get:client_staff.client.id}}" class="icon-circle2 mr-1"></i>
                                                {{client_staff.client.nama}} {% if client_staff.is_hot %} <i style="color:red"><b>(Hot Client)</b></i> {% endif %}
                                            </div>
                                            <div class="pl-1 text-muted">{{client_staff.client.email}}</div>
                                            <div class="pl-1 text-muted">
                                                {% if client.source_detail_2 is not None and client.source_detail_2 != '' %}
                                                    {{client.get_source_detail_2_display}} 
                                                {% elif client.source_detail_1 is not None and client.source_detail_1 != '' %}
                                                    {{client.get_source_detail_1_display}} 
                                                {% else %}
                                                    {{client.get_source_display|default:'-'}}
                                                {% endif %}
                                            </div>

                                            

                                        </div>

                                       <div class="align-self-center ml-3">
                                            <!-- <i class="fab fa-whatsapp mr-3 whatsapp-button" data-client_id="{{client_staff.client.id}}" data-journey_type="whatsapp" style="font-size:1.8em"></i> -->
                                            <img class="list-icons-item clickable whatsapp-button" data-client_id="{{client_staff.client.id}}"  data-popup="tooltip" title="WA" data-journey_type="whatsapp" src="{% static 'magnet/images/admin-wa.png' %}" style="height:2.4em" >
                                            
                                            <!-- <i class="fas fa-phone mr-3 call-button" style="font-size: 1.8em" data-client_id="{{client_staff.client.id}}" data-journey_type="called">
                                            </i> -->
                                            
                                            <!-- <a class="list-icons-item clickable call-button" data-popup="tooltip" title="Call" data-client_id="{{client_staff.client.id}}" data-journey_type="called" data-toggle="modal" data-trigger="hover" data-target="#call"><i class="fas fa-phone mr-3" style="font-size: 1.8em"></i></a> -->

                                            <img class="list-icons-item clickable call-button" data-popup="tooltip" title="Call" data-client_id="{{client_staff.client.id}}" data-journey_type="called" data-toggle="modal" data-trigger="hover" data-target="#call" src="{% static 'magnet/images/admin-call.png' %}" style="height:2.4em" >


                                            <!-- <a class="list-icons-item" href="{% url 'client-followup-list' client_staff.client.id  %}"><i class="far fa-calendar-plus mr-3" style="font-size: 1.8em"></i></a> -->

                                            <a href="{% url 'client-followup-list' client_staff.client.id  %}"><img class="list-icons-item"  data-popup="tooltip" title="Feedback" src="{% static 'magnet/images/admin-feedback.png' %}" style="height:2.4em" ></a>


                                            <div class="list-icons">
                                                <div class="dropdown">
                                                    <a href="#" class="list-icons-item" data-toggle="dropdown">
                                                        <i class="icon-menu9" style="font-size: 1.8em"></i>
                                                    </a>

                                                    <div class="dropdown-menu dropdown-menu-right">
                                                        <a href="{% url 'client-detail-list' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="icon-file-eye"></i> Client Detail
                                                        </a>
                                                        <a href="{% url 'client-edit' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="fas fa-edit"></i> Client Edit
                                                        </a>

                                                        <a href="{% url 'client-schedule-list' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="fas fa-calendar-alt"></i> List Schedule
                                                        </a>
                                                        <a href="{% url 'client-schedule-add' client_staff.client.id  %}" class="dropdown-item">
                                                            <i class="fas fa-calendar-plus"></i> Add Schedule
                                                        </a>
                                                        <span data-toggle="modal" data-target="#modal_mini" class="dropdown-item change-color-button" data-client_id="{{client_staff.client.id}}"><i class="icon-pencil7"></i>Edit Color</span>

                                                        <span  class="dropdown-item" onclick="set_hot({{client_staff.client.id}},{% if client_staff.is_hot %}'false' {% else %} 'true' {% endif %})"><i class="icon-pencil7"></i>Toggle Hot Client</span>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </li>
                                    
                                 {% endif %}
                                {% endfor %}

                            
                        </ul>
		

					  </div>
					</div>


					

					
				</div>

			</div>
		</div>

	</div>
	<!-- /typeahead -->
</div>
<!-- Mini modal -->
<div id="modal_mini" class="modal fade" tabindex="-1">
	<div class="modal-dialog modal-xs">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Pick Color</h5>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>

			<div class="modal-body">
				<!-- <h6 class="font-weight-semibold">Text in a modal</h6> -->
				<input type="color" class="form-control"  name="client-color" id="client-color">
				
			</div>

			<div class="modal-footer">
				<button type="button" class="btn btn-link" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" id="color-button-save">Save changes</button>
			</div>
		</div>
	</div>
</div>
<!-- /mini modal -->
<script type="text/javascript">
	function set_hot(client_id,action){
		console.log("masuk hott")
		var string_color_url = "{% url 'client-set-hot' 0 '!99' %}";	
		string_color_url = string_color_url.replace(0, client_id)
		string_color_url = string_color_url.replace('!99', action)
		window.location.href = string_color_url;
	}
	$(function() {
		var client_id = '';
		$('.change-color-button').click(function(){
			client_id = $(this).data('client_id');
			console.log(client_id)

		});
		// $('#client-color').colorpicker();
		$('#color-button-save').click(function(){
			console.log(123);
			var color_value = $('#client-color').val()
			color_value = color_value.replace('#', '')
			var string_color_url = "{% url 'client-edit-color' 0 '!99' %}";
			string_color_url = string_color_url.replace(0, client_id)
			string_color_url = string_color_url.replace('!99', color_value)
			console.log(string_color_url);
			window.location.href = string_color_url;

		});
		$(".table-row").click(function() {
		 	var link = $(this).data('href');
		 	window.location.href = link;
		});

		$("#search_input").on("keyup", function() {
		  var value = this.value.toLowerCase().trim();
		  $(".media-list li").show().filter(function() {
		    return $(this).text().toLowerCase().trim().indexOf(value) == -1;
		  }).hide();
		});

	});
</script>
{% endblock content %}